%h1.post.post-subject
  - if post == @navable
    = post.subject
  - else
    = link_to post.subject, post
%div.post
  .media
    .media-left= user_avatar(post.author)
    .media-body
      %div.post-header
        %div.post-author
          - if post.author.kind_of? User
            - if post.external_author.present?
              - # The user has sent from a non-registered email. Display it!
              = link_to post.external_author, post.author
            - else
              = link_to post.author.title, post.author
          - if post.author.kind_of? String
            = post.author
          
          - if @navable != post.group
            %span.post-group.right
              = icon(:tag)
              = link_to post.group.title, post.group
        %div.post-date
          = localize(post.sent_at)
          
      %div.post-body
        = markup post.text.html_safe
      
      - if post.attachments.count > 0  
        %div.post-attachments
          %strong= t(:attachments)
          %ol.post_attachments
            - post.attachments.each do |attachment|
              %li
                = awesome_icon(:paperclip)
                = link_to attachment.filename, attachment.file.url, target: '_blank'

      .post-comments= render partial: 'comments/comments', locals: {commentable: post}
