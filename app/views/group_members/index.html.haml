/ Page title
.page-header
  .row.align-items-center
    .col-auto
      %h2.page-title
        = current_title

.row
  .col-lg-9
    .card
      .card-body
        %vue-group-members-table{':rows': member_table_rows.to_json}

  .col-lg-3
    .card
      .card-body
        - if can? :add_group_member, group
          = link_to new_group_member_path(group_id: group.id), class: 'btn btn-success' do
            = t :add_member

        %h3.mt-4 Export
        = render partial: 'groups/export_button'

        %h3.mt-4 Statistik
        - if can?(:use, :term_reports) && group.corporation
          .tool.term_reports
            = link_to group_term_report_path(group), class: 'btn btn-outline-secondary' do
              = fa_icon 'bar-chart'
              = t(:term_report)

        %h3.mt-4 Mitgliederverwaltung
        - if can? :renew_cache, group
          .tool.renew_cache= renew_cache_button(group)
        - if can? :update_members, group
          = link_to group_member_data_summaries_path(group), class: 'btn btn-outline-secondary' do
            = icon 'folder-open'
            = t(:data_administration)
        - if can? :manage_memberships_manually, group
          = link_to t(:memberships), group_memberships_path(group), class: 'btn btn-outline-secondary'

    - if can? :add_group_member_manually, group
      .card
        .card-body
          %h3= t :add_members_manually
          %div.add_group_members
            = form_for new_membership, url: group_members_memberships_path(format: 'json') do |form|
              %span.add_group_member_name_field.left
                = form.text_field :user_title, 'data-autocomplete-url' => titles_api_v1_users_path, :class => 'user-select-input new-membership', placeholder: t(:enter_last_name_wait_and_select_from_list)
              %span.add_group_member_tools.right
                = form.date_select :valid_from, value: Date.today, class: 'valid-from-field', start_year: 1950, end_year: Time.now.year + 5
                = form.submit t(:add), class: 'btn btn-primary add-user-button'

    - if group.child_groups.any?
      .card
        .card-body
          %h3 Untergruppen
          = group_tree(group) do |child_group|
            - link_to child_group.name, group_members_path(child_group)

-#-# %h1 Mitglied werden
-#-# %div
-#-#   - if @own_memberships.now.count == 0
-#-#     %a.btn.btn-success Beitreten
-#-#   - elsif @own_memberships.now.direct.count > 0
-#-#     %a.btn.btn-danger Gruppe verlassen
-#-#   - @own_memberships.each do |membership|
-#-#     %p
-#-#       Mitglied seit
-#-#       = localize membership.valid_from.to_date if membership.valid_from
-#-#       = "bis #{localize membership.valid_to.to_date}" if membership.valid_to
-#
-#-#%h1.group_members_map= t :map
-#-#%div
-#-#  .google_maps.with_info_window{data: {datatable: 'table.members'}}